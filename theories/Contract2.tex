\documentclass[12pt]{report}
\usepackage[]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{fullpage}
\usepackage{coqdoc}
\usepackage{amsmath,amssymb}
\usepackage{url}
\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% This file has been automatically generated with the command
%% coqdoc --latex Contract2.v 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\coqlibrary{Contract2}{Library }{Contract2}

\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Lists.List}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{FunInd}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Bool.Bool}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Bool.Sumbool}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Structures.GenericMinMax}.\coqdoceol
\coqdocnoindent
\coqdockw{From} \coqdockw{Equations} \coqdockw{Require} \coqdockw{Import} \coqdockw{Equations}.\coqdoceol
\coqdocnoindent
\coqdockw{Import} \coqdocvar{ListNotations}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{micromega.Lia}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Setoid}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Init.Tauto} \coqdocvar{btauto.Btauto}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Logic.ClassicalFacts}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{EventType} : \coqdockw{Type} :=\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Transfer} : \coqdocvar{EventType}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Notify} : \coqdocvar{EventType}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Scheme} \coqdocvar{Equality} \coqdockw{for} \coqdocvar{EventType}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{Trace} := \coqdocvar{List.list} \coqdocvar{EventType} \% \coqdockw{type}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{Contract} : \coqdockw{Set} :=\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Success} : \coqdocvar{Contract}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Failure} : \coqdocvar{Contract}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Event} : \coqdocvar{EventType} \ensuremath{\rightarrow} \coqdocvar{Contract}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{CPlus} : \coqdocvar{Contract} \ensuremath{\rightarrow} \coqdocvar{Contract} \ensuremath{\rightarrow} \coqdocvar{Contract}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{CSeq} : \coqdocvar{Contract} \ensuremath{\rightarrow} \coqdocvar{Contract} \ensuremath{\rightarrow} \coqdocvar{Contract}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Notation} "e \_.\_ c" := (\coqdocvar{CSeq} (\coqdocvar{Event} \coqdocvar{e}) \coqdocvar{c})\coqdoceol
\coqdocindent{10.00em}
(\coqdoctac{at} \coqdockw{level} 51, \coqdoctac{right} \coqdockw{associativity}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Notation} "c0 \_;\_ c1"  := (\coqdocvar{CSeq} \coqdocvar{c0} \coqdocvar{c1})\coqdoceol
\coqdocindent{12.50em}
(\coqdoctac{at} \coqdockw{level} 52, \coqdoctac{left} \coqdockw{associativity}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Notation} "c0 \_+\_ c1"  := (\coqdocvar{CPlus} \coqdocvar{c0} \coqdocvar{c1})\coqdoceol
\coqdocindent{12.50em}
(\coqdoctac{at} \coqdockw{level} 53, \coqdoctac{left} \coqdockw{associativity}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Scheme} \coqdocvar{Equality} \coqdockw{for} \coqdocvar{Contract}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{nu}(\coqdocvar{c}:\coqdocvar{Contract}):\coqdocvar{bool} :=\coqdoceol
\coqdocnoindent
\coqdockw{match} \coqdocvar{c} \coqdockw{with}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Success} \ensuremath{\Rightarrow} \coqdocvar{true}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Failure} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Event} \coqdocvar{e} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{c0} \coqdocvar{\_};\coqdocvar{\_} \coqdocvar{c1} \ensuremath{\Rightarrow} \coqdocvar{nu} \coqdocvar{c0} \&\& \coqdocvar{nu} \coqdocvar{c1}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{c0} \coqdocvar{\_}+\coqdocvar{\_} \coqdocvar{c1} \ensuremath{\Rightarrow} \coqdocvar{nu} \coqdocvar{c0} || \coqdocvar{nu} \coqdocvar{c1}\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{o} (\coqdocvar{c} : \coqdocvar{Contract}) := \coqdockw{if} \coqdocvar{nu} \coqdocvar{c} \coqdockw{then} \coqdocvar{Success} \coqdockw{else} \coqdocvar{Failure}.\coqdoceol
\coqdocnoindent
\coqdockw{Hint Unfold} \coqdocvar{o} : \coqdocvar{core}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{o\_Failure} : \coqdocvar{o} \coqdocvar{Failure} = \coqdocvar{Failure}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{o\_Success} : \coqdocvar{o} \coqdocvar{Success} = \coqdocvar{Success}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{o\_or} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{c} : \coqdocvar{Contract}), \coqdocvar{o} \coqdocvar{c} = \coqdocvar{Success} \ensuremath{\land} \coqdocvar{nu} \coqdocvar{c} = \coqdocvar{true} \ensuremath{\lor} \coqdocvar{o} \coqdocvar{c} = \coqdocvar{Failure} \ensuremath{\land} \coqdocvar{nu} \coqdocvar{c} = \coqdocvar{false}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{unfold} \coqdocvar{o}. \coqdoctac{destruct} (\coqdocvar{nu} \coqdocvar{c}) \coqdocvar{eqn}:\coqdocvar{Heqn}; \coqdoctac{intuition}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{o\_idempotent} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{c} : \coqdocvar{Contract}), \coqdocvar{o} (\coqdocvar{o} \coqdocvar{c}) = \coqdocvar{o} \coqdocvar{c}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{destruct} (\coqdocvar{o\_or} \coqdocvar{c}). \coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{H};\coqdoctac{auto}. \coqdoctac{destruct} \coqdocvar{H}. \coqdocvar{now} \coqdoctac{rewrite} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hint Rewrite} \coqdocvar{o\_Failure} \coqdocvar{o\_Success} \coqdocvar{o\_idempotent} : \coqdocvar{cDB}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Reserved Notation} "e \symbol{92} c" (\coqdoctac{at} \coqdockw{level} 40, \coqdoctac{left} \coqdockw{associativity}).\coqdoceol
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{derive} (\coqdocvar{e}:\coqdocvar{EventType}) (\coqdocvar{c}:\coqdocvar{Contract}) :\coqdocvar{Contract} :=\coqdoceol
\coqdocnoindent
\coqdockw{match} \coqdocvar{c} \coqdockw{with}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Success} \ensuremath{\Rightarrow} \coqdocvar{Failure}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Failure} \ensuremath{\Rightarrow} \coqdocvar{Failure}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Event} \coqdocvar{e'} \ensuremath{\Rightarrow} \coqdockw{if} (\coqdocvar{EventType\_eq\_dec} \coqdocvar{e'} \coqdocvar{e}) \coqdockw{then} \coqdocvar{Success} \coqdockw{else} \coqdocvar{Failure}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{c0} \coqdocvar{\_};\coqdocvar{\_} \coqdocvar{c1} \ensuremath{\Rightarrow} \coqdocvar{o} \coqdocvar{c0} \coqdocvar{\_};\coqdocvar{\_} \coqdocvar{e} \symbol{92} \coqdocvar{c1} \coqdocvar{\_}+\coqdocvar{\_} \coqdocvar{e} \symbol{92} \coqdocvar{c0} \coqdocvar{\_};\coqdocvar{\_} \coqdocvar{c1}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{c0} \coqdocvar{\_}+\coqdocvar{\_} \coqdocvar{c1} \ensuremath{\Rightarrow} \coqdocvar{e} \symbol{92} \coqdocvar{c0} \coqdocvar{\_}+\coqdocvar{\_} \coqdocvar{e} \symbol{92} \coqdocvar{c1}\coqdoceol
\coqdocnoindent
\coqdockw{end}\coqdoceol
\coqdocnoindent
\coqdockw{where} "e \symbol{92} c" := (\coqdocvar{derive} \coqdocvar{e} \coqdocvar{c}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Ltac} \coqdocvar{destruct\_ctx} :=\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{repeat} \coqdockw{match} \coqdockw{goal} \coqdockw{with}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} [ \coqdocvar{H}: ?\coqdocvar{H0} \ensuremath{\land} ?\coqdocvar{H1} \ensuremath{\vdash} \coqdocvar{\_} ] \ensuremath{\Rightarrow} \coqdoctac{destruct} \coqdocvar{H}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} [ \coqdocvar{H}: \coqdoctac{\ensuremath{\exists}} \coqdocvar{\_}, \coqdocvar{\_}  \ensuremath{\vdash} \coqdocvar{\_} ] \ensuremath{\Rightarrow} \coqdoctac{destruct} \coqdocvar{H}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Ltac} \coqdocvar{o\_destruct} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdockw{goal} \coqdockw{with}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} [ \ensuremath{\vdash} \coqdockw{context}[(\coqdocvar{o} ?\coqdocvar{c})] ] \ensuremath{\Rightarrow} \coqdoctac{destruct} (\coqdocvar{o\_or} \coqdocvar{c});\coqdocvar{destruct\_ctx}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} [ \coqdocvar{\_} : \coqdockw{context}[ (\coqdocvar{o} ?\coqdocvar{c})] \ensuremath{\vdash} \coqdocvar{\_} ] \ensuremath{\Rightarrow} \coqdockw{let} \coqdocvar{H} := \coqdoctac{fresh} "H" \coqdoctac{in} \coqdoceol
\coqdocindent{22.00em}
\coqdockw{let} \coqdocvar{H1} := \coqdoctac{fresh} "H1" \coqdoctac{in} \coqdoceol
\coqdocindent{22.00em}
\coqdoctac{destruct} (\coqdocvar{o\_or} \coqdocvar{c}) \coqdockw{as} [[\coqdocvar{H} \coqdocvar{H1}] \ensuremath{|} [\coqdocvar{H} \coqdocvar{H1}]];\coqdoceol
\coqdocindent{22.00em}
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in}*;\coqdoctac{clear} \coqdocvar{H}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{o\_derive} : \coqdockw{\ensuremath{\forall}} \coqdocvar{c} \coqdocvar{e}, \coqdocvar{e} \symbol{92} (\coqdocvar{o} \coqdocvar{c}) = \coqdocvar{Failure}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdocvar{o\_destruct}. \coqdoctac{unfold} \coqdocvar{o}. \coqdoctac{rewrite} \coqdocvar{H0}. \coqdocvar{now} \coqdoctac{simpl}. \coqdoctac{unfold} \coqdocvar{o}. \coqdoctac{rewrite} \coqdocvar{H0}. \coqdocvar{now} \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hint Rewrite} \coqdocvar{o\_idempotent} \coqdocvar{o\_derive} : \coqdocvar{cDB}.\coqdoceol
\coqdocnoindent
\coqdockw{Ltac} \coqdocvar{autoIC} := \coqdoctac{auto} \coqdockw{with} \coqdocvar{cDB}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Reserved Notation} "s \symbol{92}\symbol{92} c" (\coqdoctac{at} \coqdockw{level} 42, \coqdockw{no} \coqdockw{associativity}).\coqdoceol
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{trace\_derive} (\coqdocvar{s} : \coqdocvar{Trace}) (\coqdocvar{c} : \coqdocvar{Contract})  : \coqdocvar{Contract} :=\coqdoceol
\coqdocnoindent
\coqdockw{match} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocnoindent
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{c}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{e}::\coqdocvar{s'} \ensuremath{\Rightarrow} \coqdocvar{s'} \symbol{92}\symbol{92} (\coqdocvar{e} \symbol{92} \coqdocvar{c})\coqdoceol
\coqdocnoindent
\coqdockw{end}\coqdoceol
\coqdocnoindent
\coqdockw{where} "s \symbol{92}\symbol{92} c" := (\coqdocvar{trace\_derive} \coqdocvar{s} \coqdocvar{c}).\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{matchesb} (\coqdocvar{c} : \coqdocvar{Contract})(\coqdocvar{s} : \coqdocvar{Trace}) := \coqdocvar{nu} (\coqdocvar{s}\symbol{92}\symbol{92}\coqdocvar{c}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Reserved Notation} "s =\~{} re" (\coqdoctac{at} \coqdockw{level} 63).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{Matches\_Comp} : \coqdocvar{Trace} \ensuremath{\rightarrow} \coqdocvar{Contract} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{MSuccess} : [] $=\sim$ \coqdocvar{Success}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{MEvent} \coqdocvar{x} : [\coqdocvar{x}] $=\sim$ (\coqdocvar{Event} \coqdocvar{x})\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{MSeq} \coqdocvar{s1} \coqdocvar{c1} \coqdocvar{s2} \coqdocvar{c2}\coqdoceol
\coqdocindent{6.50em}
(\coqdocvar{H1} : \coqdocvar{s1} $=\sim$ \coqdocvar{c1})\coqdoceol
\coqdocindent{6.50em}
(\coqdocvar{H2} : \coqdocvar{s2} $=\sim$ \coqdocvar{c2})\coqdoceol
\coqdocindent{5.50em}
: (\coqdocvar{s1} ++ \coqdocvar{s2}) $=\sim$ (\coqdocvar{c1} \coqdocvar{\_};\coqdocvar{\_} \coqdocvar{c2})\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{MPlusL} \coqdocvar{s1} \coqdocvar{c1} \coqdocvar{c2}\coqdoceol
\coqdocindent{8.00em}
(\coqdocvar{H1} : \coqdocvar{s1} $=\sim$ \coqdocvar{c1})\coqdoceol
\coqdocindent{7.00em}
: \coqdocvar{s1} $=\sim$ (\coqdocvar{c1} \coqdocvar{\_}+\coqdocvar{\_} \coqdocvar{c2})\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{MPlusR} \coqdocvar{c1} \coqdocvar{s2} \coqdocvar{c2}\coqdoceol
\coqdocindent{8.00em}
(\coqdocvar{H2} : \coqdocvar{s2} $=\sim$ \coqdocvar{c2})\coqdoceol
\coqdocindent{7.00em}
: \coqdocvar{s2} $=\sim$ (\coqdocvar{c1} \coqdocvar{\_}+\coqdocvar{\_} \coqdocvar{c2})\coqdoceol
\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
\coqdockw{where} "s =\~{} c" := (\coqdocvar{Matches\_Comp} \coqdocvar{s} \coqdocvar{c}).\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hint Constructors} \coqdocvar{Matches\_Comp} : \coqdocvar{cDB}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Ltac} \coqdocvar{eq\_event\_destruct} :=\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{repeat} \coqdockw{match} \coqdockw{goal} \coqdockw{with}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} [ \ensuremath{\vdash} \coqdockw{context}[\coqdocvar{EventType\_eq\_dec} ?\coqdocvar{e} ?\coqdocvar{e0}] ] \ensuremath{\Rightarrow} \coqdoctac{destruct} (\coqdocvar{EventType\_eq\_dec} \coqdocvar{e} \coqdocvar{e0});\coqdoctac{try} \coqdocvar{contradiction}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} [ \coqdocvar{\_} : \coqdockw{context}[\coqdocvar{EventType\_eq\_dec} ?\coqdocvar{e} ?\coqdocvar{e0}]  \ensuremath{\vdash} \coqdocvar{\_} ] \ensuremath{\Rightarrow} \coqdoctac{destruct} (\coqdocvar{EventType\_eq\_dec} \coqdocvar{e} \coqdocvar{e0});\coqdoctac{try} \coqdocvar{contradiction}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{seq\_Success} : \coqdockw{\ensuremath{\forall}} \coqdocvar{c} \coqdocvar{s}, \coqdocvar{s} $=\sim$ \coqdocvar{Success} \coqdocvar{\_};\coqdocvar{\_} \coqdocvar{c} \ensuremath{\leftrightarrow} \coqdocvar{s} $=\sim$ \coqdocvar{c}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{split};\coqdoctac{intros}. \coqdoctac{inversion} \coqdocvar{H}. \coqdoctac{inversion} \coqdocvar{H3}. \coqdoctac{subst}. \coqdocvar{now} \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{app\_nil\_l} \coqdocvar{s}). \coqdocvar{autoIC}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{seq\_Failure} : \coqdockw{\ensuremath{\forall}} \coqdocvar{c} \coqdocvar{s}, \coqdocvar{s} $=\sim$ \coqdocvar{Failure} \coqdocvar{\_};\coqdocvar{\_} \coqdocvar{c} \ensuremath{\leftrightarrow} \coqdocvar{s} $=\sim$ \coqdocvar{Failure}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{split};\coqdoctac{intros}. \coqdoctac{inversion} \coqdocvar{H}. \coqdoctac{inversion} \coqdocvar{H3}. \coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hint Resolve} \coqdocvar{seq\_Success} \coqdocvar{seq\_Failure} : \coqdocvar{cDB}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{derive\_distr\_plus} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{s} : \coqdocvar{Trace})(\coqdocvar{c0} \coqdocvar{c1} : \coqdocvar{Contract}), \coqdocvar{s} \symbol{92}\symbol{92} (\coqdocvar{c0} \coqdocvar{\_}+\coqdocvar{\_} \coqdocvar{c1}) = \coqdocvar{s} \symbol{92}\symbol{92} \coqdocvar{c0} \coqdocvar{\_}+\coqdocvar{\_} \coqdocvar{s} \symbol{92}\symbol{92} \coqdocvar{c1}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{s};\coqdoctac{intros};\coqdoctac{simpl};\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocnoindent
\coqdockw{Check} \coqdocvar{existsb}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{o\_true} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{c}: \coqdocvar{Contract}), \coqdocvar{nu} \coqdocvar{c} = \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{o} \coqdocvar{c} = \coqdocvar{Success}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdocvar{o\_destruct};\coqdoctac{auto} \coqdockw{with} \coqdocvar{cDB}. \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{o\_false} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{c}: \coqdocvar{Contract}), \coqdocvar{nu} \coqdocvar{c} = \coqdocvar{false} \ensuremath{\rightarrow} \coqdocvar{o} \coqdocvar{c} = \coqdocvar{Failure}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdocvar{o\_destruct}. \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{discriminate}. \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hint Rewrite} \coqdocvar{derive\_distr\_plus} : \coqdocvar{cDB}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{nu\_seq\_derive} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{e} : \coqdocvar{EventType})(\coqdocvar{c0} \coqdocvar{c1} : \coqdocvar{Contract}), \coqdoceol
\coqdocnoindent
\coqdocvar{nu} \coqdocvar{c0} = \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{nu} (\coqdocvar{e} \symbol{92} \coqdocvar{c1}) = \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{nu} (\coqdocvar{e} \symbol{92} (\coqdocvar{c0} \coqdocvar{\_};\coqdocvar{\_} \coqdocvar{c1})) = \coqdocvar{true}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{orb\_true\_iff}. \coqdoctac{left}. \coqdoctac{rewrite} \coqdocvar{o\_true};\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{nu\_Failure} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{s} : \coqdocvar{Trace})(\coqdocvar{c} : \coqdocvar{Contract}), \coqdocvar{nu} (\coqdocvar{s} \symbol{92}\symbol{92} (\coqdocvar{Failure} \coqdocvar{\_};\coqdocvar{\_} \coqdocvar{c})) = \coqdocvar{false}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{s};\coqdoctac{intros}. \coqdocvar{now} \coqdoctac{simpl}. \coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{o\_false};\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{derive\_distr\_plus}. \coqdoctac{simpl}. \coqdocvar{now} \coqdoctac{repeat} \coqdoctac{rewrite} \coqdocvar{IHs}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hint Rewrite} \coqdocvar{nu\_Failure} : \coqdocvar{cDB}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{nu\_Success} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{s} : \coqdocvar{Trace})(\coqdocvar{c} : \coqdocvar{Contract}), \coqdocvar{nu} (\coqdocvar{s} \symbol{92}\symbol{92} (\coqdocvar{Success} \coqdocvar{\_};\coqdocvar{\_} \coqdocvar{c})) = \coqdocvar{nu} (\coqdocvar{s} \symbol{92}\symbol{92} \coqdocvar{c}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{s};\coqdoctac{intros};\coqdoctac{simpl};\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{autorewrite} \coqdockw{with} \coqdocvar{cDB} \coqdockw{using} \coqdoctac{simpl};\coqdoctac{auto}. \coqdoctac{rewrite} \coqdocvar{orb\_false\_r}. \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hint Rewrite} \coqdocvar{nu\_Failure} \coqdocvar{nu\_Success} : \coqdocvar{cDB}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{nu\_seq\_trace\_derive} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{s} : \coqdocvar{Trace})(\coqdocvar{c0} \coqdocvar{c1} : \coqdocvar{Contract}), \coqdoceol
\coqdocnoindent
\coqdocvar{nu} \coqdocvar{c0} = \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{nu} (\coqdocvar{s} \symbol{92}\symbol{92} \coqdocvar{c1}) = \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{nu} (\coqdocvar{s} \symbol{92}\symbol{92} (\coqdocvar{c0} \coqdocvar{\_};\coqdocvar{\_} \coqdocvar{c1})) = \coqdocvar{true}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{s};\coqdoctac{intros};\coqdoctac{simpl} \coqdoctac{in} *. \coqdoctac{intuition}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{o\_true};\coqdoctac{auto}. \coqdoctac{rewrite} \coqdocvar{derive\_distr\_plus}. \coqdoctac{simpl}. \coqdoctac{autorewrite} \coqdockw{with} \coqdocvar{cDB}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0}. \coqdocvar{btauto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{matchesb\_seq} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{s0} \coqdocvar{s1} : \coqdocvar{Trace})(\coqdocvar{c0} \coqdocvar{c1} : \coqdocvar{Contract}), \coqdocvar{nu} (\coqdocvar{s0}\symbol{92}\symbol{92}\coqdocvar{c0}) = \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{nu} (\coqdocvar{s1}\symbol{92}\symbol{92}\coqdocvar{c1}) = \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{nu} ((\coqdocvar{s0}++\coqdocvar{s1})\symbol{92}\symbol{92}(\coqdocvar{c0} \coqdocvar{\_};\coqdocvar{\_c1})) = \coqdocvar{true}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{s0};\coqdoctac{intros};\coqdoctac{simpl} \coqdoctac{in} *.\coqdoceol
\coqdocnoindent
- \coqdoctac{rewrite} \coqdocvar{nu\_seq\_trace\_derive}; \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
- \coqdoctac{autorewrite} \coqdockw{with} \coqdocvar{cDB}. \coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{orb\_true\_iff}. \coqdoctac{right}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{IHs0};\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hint Rewrite} \coqdocvar{matchesb\_seq} : \coqdocvar{cDB}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Print} \coqdockw{Hint}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{Matches\_Comp\_i\_matchesb} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{c} : \coqdocvar{Contract})(\coqdocvar{s} : \coqdocvar{Trace}), \coqdocvar{s} $=\sim$ \coqdocvar{c} \ensuremath{\rightarrow} \coqdocvar{nu} (\coqdocvar{s}\symbol{92}\symbol{92}\coqdocvar{c}) = \coqdocvar{true}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{induction} \coqdocvar{H}; \coqdoceol
\coqdocnoindent
\coqdoctac{solve} [ \coqdoctac{autorewrite} \coqdockw{with} \coqdocvar{cDB}; \coqdoctac{simpl}; \coqdoctac{auto} \coqdockw{with} \coqdocvar{cDB} \coqdocvar{bool} \coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdoctac{simpl};\coqdocvar{eq\_event\_destruct};\coqdoctac{auto} ].\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{Matches\_Comp\_nil\_nu} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{c} : \coqdocvar{Contract}), \coqdocvar{nu} \coqdocvar{c} = \coqdocvar{true} \ensuremath{\rightarrow} [] $=\sim$ \coqdocvar{c}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros};\coqdoctac{induction} \coqdocvar{c}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H} ; \coqdoctac{try} \coqdoctac{discriminate}; \coqdocvar{autoIC}. \coqdoctac{apply} \coqdocvar{orb\_prop} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}; \coqdocvar{autoIC}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{app\_nil\_l} []); \coqdocvar{autoIC}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{Matches\_Comp\_derive} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{c} : \coqdocvar{Contract})(\coqdocvar{e} : \coqdocvar{EventType})(\coqdocvar{s} : \coqdocvar{Trace}), \coqdocvar{s} $=\sim$ \coqdocvar{e} \symbol{92} \coqdocvar{c}\ensuremath{\rightarrow} (\coqdocvar{e}::\coqdocvar{s}) $=\sim$ \coqdocvar{c}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{c};\coqdoctac{intros}; \coqdoctac{simpl} \coqdoctac{in}*; \coqdoctac{try} \coqdoctac{solve} [\coqdoctac{inversion} \coqdocvar{H}].\coqdoceol
\coqdocnoindent
- \coqdocvar{eq\_event\_destruct}. \coqdoctac{inversion} \coqdocvar{H}. \coqdoctac{subst}. \coqdocvar{autoIC}. \coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
- \coqdoctac{inversion} \coqdocvar{H}; \coqdocvar{autoIC}. \coqdocnoindent
- \coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\ensuremath{\times} \coqdoctac{inversion} \coqdocvar{H2}. \coqdoctac{subst}. \coqdocvar{o\_destruct}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{inversion} \coqdocvar{H7}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{app\_nil\_l} (\coqdocvar{e}::\coqdocvar{s2})). \coqdoctac{constructor}.\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{all}: \coqdoctac{auto} \coqdockw{using} \coqdocvar{Matches\_Comp\_nil\_nu}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{inversion} \coqdocvar{H7}.\coqdoceol
\coqdocindent{1.00em}
\ensuremath{\times} \coqdoctac{inversion} \coqdocvar{H1}. \coqdoctac{subst}. \coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{auto} \coqdockw{with} \coqdocvar{cDB}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{Matches\_Comp\_iff\_matchesb} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{c} : \coqdocvar{Contract})(\coqdocvar{s} : \coqdocvar{Trace}), \coqdocvar{s} $=\sim$ \coqdocvar{c} \ensuremath{\leftrightarrow} \coqdocvar{nu} (\coqdocvar{s} \symbol{92}\symbol{92} \coqdocvar{c}) = \coqdocvar{true}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{split};\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
- \coqdoctac{auto} \coqdockw{using} \coqdocvar{Matches\_Comp\_i\_matchesb}.\coqdoceol
\coqdocnoindent
- \coqdoctac{generalize} \coqdoctac{dependent} \coqdocvar{c}. \coqdoctac{induction} \coqdocvar{s};\coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{auto} \coqdockw{using} \coqdocvar{Matches\_Comp\_nil\_nu}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{auto} \coqdockw{using} \coqdocvar{Matches\_Comp\_derive}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{derive\_spec\_comp} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{c} : \coqdocvar{Contract})(\coqdocvar{e} : \coqdocvar{EventType})(\coqdocvar{s} : \coqdocvar{Trace}), \coqdocvar{e}::\coqdocvar{s} $=\sim$ \coqdocvar{c} \ensuremath{\leftrightarrow} \coqdocvar{s} $=\sim$ \coqdocvar{c} / \coqdocvar{e}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{repeat} \coqdoctac{rewrite} \coqdocvar{Matches\_Comp\_iff\_matchesb}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{plus\_fold} (\coqdocvar{l} : \coqdocvar{list} \coqdocvar{Contract}) : \coqdocvar{Contract} :=\coqdoceol
\coqdocnoindent
\coqdockw{match} \coqdocvar{l} \coqdockw{with}\coqdoceol
\coqdocnoindent
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{Failure}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{c} ::\coqdocvar{l} \ensuremath{\Rightarrow} \coqdocvar{c} \coqdocvar{\_}+\coqdocvar{\_} (\coqdocvar{plus\_fold} \coqdocvar{l})\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{plus\_assoc} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{c1} \coqdocvar{c2} \coqdocvar{c3} : \coqdocvar{Contract}), (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{s}=\~{}((\coqdocvar{c1} \coqdocvar{\_}+\coqdocvar{\_} \coqdocvar{c2}) \coqdocvar{\_}+\coqdocvar{\_} \coqdocvar{c3}) \ensuremath{\leftrightarrow} \coqdocvar{s} $=\sim$ (\coqdocvar{c1} \coqdocvar{\_}+\coqdocvar{\_} (\coqdocvar{c2} \coqdocvar{\_}+\coqdocvar{\_} \coqdocvar{c3}))).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{split};\coqdoctac{intros}. \coqdoctac{inversion} \coqdocvar{H};\coqdocvar{autoIC}. \coqdoctac{inversion} \coqdocvar{H2};\coqdocvar{autoIC}. \coqdoctac{inversion} \coqdocvar{H};\coqdocvar{autoIC}. \coqdoctac{inversion} \coqdocvar{H1};\coqdocvar{autoIC}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{plus\_fold\_app} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{s}:\coqdocvar{Trace})(\coqdocvar{l1} \coqdocvar{l2} : \coqdocvar{list} \coqdocvar{Contract}), \coqdoceol
\coqdocnoindent
\coqdocvar{s} $=\sim$ \coqdocvar{plus\_fold} (\coqdocvar{l1} ++ \coqdocvar{l2}) \ensuremath{\leftrightarrow} \coqdocvar{s} $=\sim$ (\coqdocvar{plus\_fold} \coqdocvar{l1}) \coqdocvar{\_}+\coqdocvar{\_} (\coqdocvar{plus\_fold} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}. \coqdoctac{induction} \coqdocvar{l1}.\coqdoceol
\coqdocnoindent
- \coqdoctac{intros}. \coqdoctac{split}.\coqdoceol
\coqdocindent{1.00em}
\ensuremath{\times} \coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{autoIC}.\coqdoceol
\coqdocindent{1.00em}
\ensuremath{\times} \coqdoctac{intros}. \coqdoctac{simpl}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{inversion} \coqdocvar{H}. \{  \coqdoctac{inversion} \coqdocvar{H2}. \} \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
- \coqdoctac{intros}. \coqdoctac{split}.\coqdoceol
\coqdocindent{1.00em}
\ensuremath{\times} \coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} *. \coqdoctac{inversion} \coqdocvar{H} ; \coqdocvar{autoIC}. \coqdoctac{subst}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{rewrite} \coqdocvar{IHl1} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{rewrite} \coqdocvar{plus\_assoc}. \coqdoctac{apply} \coqdocvar{MPlusR};\coqdocvar{autoIC}.\coqdoceol
\coqdocindent{1.00em}
\ensuremath{\times} \coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} *. \coqdoctac{apply} \coqdocvar{plus\_assoc} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{inversion} \coqdocvar{H};\coqdocvar{autoIC}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{MPlusR}. \coqdoctac{rewrite} \coqdocvar{IHl1}. \coqdocvar{autoIC}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{in\_plus\_fold} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{s} : \coqdocvar{Trace})(\coqdocvar{l} : \coqdocvar{list} \coqdocvar{Contract}), \coqdocvar{s} $=\sim$ \coqdocvar{plus\_fold} \coqdocvar{l} \ensuremath{\leftrightarrow} \coqdoceol
\coqdocnoindent
(\coqdoctac{\ensuremath{\exists}} \coqdocvar{c}, \coqdocvar{In} \coqdocvar{c} \coqdocvar{l} \ensuremath{\land} \coqdocvar{s} $=\sim$ \coqdocvar{c}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{split}.\coqdoceol
\coqdocnoindent
- \coqdoctac{induction} \coqdocvar{l}.\coqdoceol
\coqdocindent{1.00em}
\ensuremath{\times} \coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\ensuremath{\times} \coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{inversion} \coqdocvar{H};\coqdocvar{autoIC}.\coqdoceol
\coqdocindent{2.00em}
** \coqdoctac{\ensuremath{\exists}} \coqdocvar{a}. \coqdoctac{split}. \coqdoctac{apply} \coqdocvar{in\_eq}. \coqdoctac{assumption}.\coqdoceol
\coqdocindent{2.00em}
** \coqdoctac{apply} \coqdocvar{IHl} \coqdoctac{in} \coqdocvar{H1} \coqdockw{as} [\coqdocvar{c'} [\coqdocvar{P1} \coqdocvar{P2}]]. \coqdoctac{\ensuremath{\exists}} \coqdocvar{c'}. \coqdoctac{split} ; \coqdoctac{auto} \coqdockw{using}  \coqdocvar{in\_cons}.\coqdoceol
\coqdocnoindent
- \coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [ \coqdocvar{c'} [\coqdocvar{P1} \coqdocvar{P2}]]. \coqdoctac{induction} \coqdocvar{l}.\coqdoceol
\coqdocindent{1.00em}
\ensuremath{\times} \coqdoctac{destruct} \coqdocvar{P1}.\coqdoceol
\coqdocindent{1.00em}
\ensuremath{\times} \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{P1}. \coqdoctac{destruct} \coqdocvar{P1}.\coqdoceol
\coqdocindent{2.00em}
** \coqdoctac{subst}. \coqdoctac{simpl}. \coqdocvar{autoIC}.\coqdoceol
\coqdocindent{2.00em}
** \coqdoctac{simpl}. \coqdocvar{autoIC}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{plus\_fold\_derive} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{l} : \coqdocvar{list} \coqdocvar{Contract}) (\coqdocvar{e} : \coqdocvar{EventType}), (\coqdocvar{plus\_fold} \coqdocvar{l}) / \coqdocvar{e} = \coqdocvar{plus\_fold} (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{c} \ensuremath{\Rightarrow} \coqdocvar{c}/\coqdocvar{e}) \coqdocvar{l}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l};\coqdoctac{intros};\coqdoctac{simpl};\coqdoctac{auto};\coqdoctac{f\_equal};\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\end{document}
